{
  "commit": "d7e33eb",
  "parent": "9e72063501c6b899945c1d69b785eef9ce6a36df",
  "repo": "D:\\locbench\\mistune",
  "num_files_in_diff": 1,
  "num_py_files_in_diff": 1,
  "num_seeds": 2,
  "seeds": [
    {
      "path": "tests/test_misc.py",
      "version": "new",
      "line": 133,
      "kind": "function",
      "qualname": "tests.test_misc.TestMiscCases.test_unicode_whitespace",
      "span": [
        133,
        137
      ],
      "reason": "diff_new_line_in_def",
      "is_test": true,
      "seed_type": "test_change",
      "new_code": "    def test_unicode_whitespace(self):\n        text = \"# \\u3000\\u3000abc\"\n        result = mistune.html(text)\n        expected = \"<h1>\\u3000\\u3000abc</h1>\\n\"\n        self.assertEqual(result, expected)",
      "old_code": null
    },
    {
      "path": "tests/test_misc.py",
      "version": "new",
      "line": 138,
      "kind": "class",
      "qualname": "tests.test_misc.TestMiscCases",
      "span": [
        5,
        143
      ],
      "reason": "diff_new_line_in_def",
      "is_test": true,
      "seed_type": "test_change",
      "new_code": "class TestMiscCases(TestCase):\n    def test_none(self):\n        self.assertEqual(mistune.html(None), \"\")\n\n    def test_before_parse_hooks(self):\n        def _add_name(md, state):\n            state.env[\"name\"] = \"test\"\n\n        md = mistune.create_markdown()\n        md.before_parse_hooks.append(_add_name)\n        state = md.block.state_cls()\n        md.parse(\"\", state)\n        self.assertEqual(state.env[\"name\"], \"test\")\n\n    def test_hard_wrap(self):\n        md = mistune.create_markdown(escape=False, hard_wrap=True)\n        result = md(\"foo\\nbar\")\n        expected = \"<p>foo<br />\\nbar</p>\"\n        self.assertEqual(result.strip(), expected)\n\n        md = mistune.create_markdown(escape=False, hard_wrap=True, plugins=[\"speedup\"])\n        result = md(\"foo\\nbar\")\n        self.assertEqual(result.strip(), expected)\n\n    def test_escape_html(self):\n        md = mistune.create_markdown(escape=True)\n        result = md(\"<div>1</div>\")\n        expected = \"<p>&lt;div&gt;1&lt;/div&gt;</p>\"\n        self.assertEqual(result.strip(), expected)\n\n        result = md(\"<em>1</em>\")\n        expected = \"<p>&lt;em&gt;1&lt;/em&gt;</p>\"\n        self.assertEqual(result.strip(), expected)\n\n    def test_harmful_links(self):\n        result = mistune.html(\"[h](javAscript:alert)\")\n        expected = '<p><a href=\"#harmful-link\">h</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_ref_link(self):\n        result = mistune.html(\"[link][h]\\n\\n[h]: /foo\")\n        expected = '<p><a href=\"/foo\">link</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_allow_harmful_protocols(self):\n        renderer = mistune.HTMLRenderer(allow_harmful_protocols=True)\n        md = mistune.Markdown(renderer)\n        result = md(\"[h](javascript:alert)\")\n        expected = '<p><a href=\"javascript:alert\">h</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_allow_data_protocols(self):\n        renderer = mistune.HTMLRenderer(allow_harmful_protocols=[\"data:\"])\n        md = mistune.Markdown(renderer)\n        result = md(\"[h](data:alert)\")\n        expected = '<p><a href=\"data:alert\">h</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_use_plugin(self):\n        from mistune.plugins.url import url\n\n        md = mistune.Markdown(mistune.HTMLRenderer())\n        md.use(url)\n\n    def test_markdown_func(self):\n        result = mistune.markdown(\"**b**\")\n        expected = \"<p><strong>b</strong></p>\\n\"\n        self.assertEqual(result, expected)\n\n        # trigger to use cached parser\n        result = mistune.markdown(\"**b**\")\n        self.assertEqual(result, expected)\n\n    def test_ast_output(self):\n        md = mistune.create_markdown(escape=False, renderer=None)\n        text = '# h1\\n\\nfoo **bar**\\n\\n`&<>\"`'\n        result = md(text)\n        expected = [\n            {\n                \"type\": \"heading\",\n                \"children\": [{\"type\": \"text\", \"raw\": \"h1\"}],\n                \"attrs\": {\"level\": 1},\n                \"style\": \"atx\",\n            },\n            {\"type\": \"blank_line\"},\n            {\n                \"type\": \"paragraph\",\n                \"children\": [\n                    {\"type\": \"text\", \"raw\": \"foo \"},\n                    {\"type\": \"strong\", \"children\": [{\"type\": \"text\", \"raw\": \"bar\"}]},\n                ],\n            },\n            {\"type\": \"blank_line\"},\n            {\n                \"type\": \"paragraph\",\n                \"children\": [\n                    {\"type\": \"codespan\", \"raw\": '&<>\"'},\n                ],\n            },\n        ]\n        self.assertEqual(result, expected)\n\n    def test_ast_url(self):\n        md = mistune.create_markdown(escape=False, renderer=None)\n        label = 'hi &<>\"'\n        url = \"https://example.com/foo?a=1&b=2\"\n        text = \"[{}]({})\".format(label, url)\n        result = md(text)\n        expected = [\n            {\n                \"type\": \"paragraph\",\n                \"children\": [\n                    {\n                        \"type\": \"link\",\n                        \"children\": [{\"type\": \"text\", \"raw\": label}],\n                        \"attrs\": {\"url\": url},\n                    },\n                ],\n            },\n        ]\n        self.assertEqual(result, expected)\n\n    def test_emsp(self):\n        md = mistune.create_markdown(escape=False, hard_wrap=True)\n        result = md(\"\\u2003\\u2003foo\\nbar\\n\\n\\u2003\\u2003foobar\")\n        expected = \"<p>\\u2003\\u2003foo<br />\\nbar</p>\\n<p>\\u2003\\u2003foobar</p>\"\n        self.assertEqual(result.strip(), expected)\n\n    def test_unicode_whitespace(self):\n        text = \"# \\u3000\\u3000abc\"\n        result = mistune.html(text)\n        expected = \"<h1>\\u3000\\u3000abc</h1>\\n\"\n        self.assertEqual(result, expected)\n\n    def test_html_tag_text_following_list(self):\n        md = mistune.create_markdown(escape=False, hard_wrap=True)\n        result = md(\"foo\\n- bar\\n\\ntable\")\n        expected = \"<p>foo</p>\\n<ul>\\n<li>bar</li>\\n</ul>\\n<p>table</p>\"\n        self.assertEqual(result.strip(), expected)",
      "old_code": "class TestMiscCases(TestCase):\n    def test_none(self):\n        self.assertEqual(mistune.html(None), \"\")\n\n    def test_before_parse_hooks(self):\n        def _add_name(md, state):\n            state.env[\"name\"] = \"test\"\n\n        md = mistune.create_markdown()\n        md.before_parse_hooks.append(_add_name)\n        state = md.block.state_cls()\n        md.parse(\"\", state)\n        self.assertEqual(state.env[\"name\"], \"test\")\n\n    def test_hard_wrap(self):\n        md = mistune.create_markdown(escape=False, hard_wrap=True)\n        result = md(\"foo\\nbar\")\n        expected = \"<p>foo<br />\\nbar</p>\"\n        self.assertEqual(result.strip(), expected)\n\n        md = mistune.create_markdown(escape=False, hard_wrap=True, plugins=[\"speedup\"])\n        result = md(\"foo\\nbar\")\n        self.assertEqual(result.strip(), expected)\n\n    def test_escape_html(self):\n        md = mistune.create_markdown(escape=True)\n        result = md(\"<div>1</div>\")\n        expected = \"<p>&lt;div&gt;1&lt;/div&gt;</p>\"\n        self.assertEqual(result.strip(), expected)\n\n        result = md(\"<em>1</em>\")\n        expected = \"<p>&lt;em&gt;1&lt;/em&gt;</p>\"\n        self.assertEqual(result.strip(), expected)\n\n    def test_harmful_links(self):\n        result = mistune.html(\"[h](javAscript:alert)\")\n        expected = '<p><a href=\"#harmful-link\">h</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_ref_link(self):\n        result = mistune.html(\"[link][h]\\n\\n[h]: /foo\")\n        expected = '<p><a href=\"/foo\">link</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_allow_harmful_protocols(self):\n        renderer = mistune.HTMLRenderer(allow_harmful_protocols=True)\n        md = mistune.Markdown(renderer)\n        result = md(\"[h](javascript:alert)\")\n        expected = '<p><a href=\"javascript:alert\">h</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_allow_data_protocols(self):\n        renderer = mistune.HTMLRenderer(allow_harmful_protocols=[\"data:\"])\n        md = mistune.Markdown(renderer)\n        result = md(\"[h](data:alert)\")\n        expected = '<p><a href=\"data:alert\">h</a></p>'\n        self.assertEqual(result.strip(), expected)\n\n    def test_use_plugin(self):\n        from mistune.plugins.url import url\n\n        md = mistune.Markdown(mistune.HTMLRenderer())\n        md.use(url)\n\n    def test_markdown_func(self):\n        result = mistune.markdown(\"**b**\")\n        expected = \"<p><strong>b</strong></p>\\n\"\n        self.assertEqual(result, expected)\n\n        # trigger to use cached parser\n        result = mistune.markdown(\"**b**\")\n        self.assertEqual(result, expected)\n\n    def test_ast_output(self):\n        md = mistune.create_markdown(escape=False, renderer=None)\n        text = '# h1\\n\\nfoo **bar**\\n\\n`&<>\"`'\n        result = md(text)\n        expected = [\n            {\n                \"type\": \"heading\",\n                \"children\": [{\"type\": \"text\", \"raw\": \"h1\"}],\n                \"attrs\": {\"level\": 1},\n                \"style\": \"atx\",\n            },\n            {\"type\": \"blank_line\"},\n            {\n                \"type\": \"paragraph\",\n                \"children\": [\n                    {\"type\": \"text\", \"raw\": \"foo \"},\n                    {\"type\": \"strong\", \"children\": [{\"type\": \"text\", \"raw\": \"bar\"}]},\n                ],\n            },\n            {\"type\": \"blank_line\"},\n            {\n                \"type\": \"paragraph\",\n                \"children\": [\n                    {\"type\": \"codespan\", \"raw\": '&<>\"'},\n                ],\n            },\n        ]\n        self.assertEqual(result, expected)\n\n    def test_ast_url(self):\n        md = mistune.create_markdown(escape=False, renderer=None)\n        label = 'hi &<>\"'\n        url = \"https://example.com/foo?a=1&b=2\"\n        text = \"[{}]({})\".format(label, url)\n        result = md(text)\n        expected = [\n            {\n                \"type\": \"paragraph\",\n                \"children\": [\n                    {\n                        \"type\": \"link\",\n                        \"children\": [{\"type\": \"text\", \"raw\": label}],\n                        \"attrs\": {\"url\": url},\n                    },\n                ],\n            },\n        ]\n        self.assertEqual(result, expected)\n\n    def test_emsp(self):\n        md = mistune.create_markdown(escape=False, hard_wrap=True)\n        result = md(\"\\u2003\\u2003foo\\nbar\\n\\n\\u2003\\u2003foobar\")\n        expected = \"<p>\\u2003\\u2003foo<br />\\nbar</p>\\n<p>\\u2003\\u2003foobar</p>\"\n        self.assertEqual(result.strip(), expected)\n\n    def test_html_tag_text_following_list(self):\n        md = mistune.create_markdown(escape=False, hard_wrap=True)\n        result = md(\"foo\\n- bar\\n\\ntable\")\n        expected = \"<p>foo</p>\\n<ul>\\n<li>bar</li>\\n</ul>\\n<p>table</p>\"\n        self.assertEqual(result.strip(), expected)"
    }
  ],
  "generated_at": "2026-02-10T14:56:38"
}